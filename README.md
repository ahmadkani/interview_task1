<h1>تسک: طراحی یک سیستم مدیریت فایل با Web Worker و IndexedDB</h1>

<h2>شرح کلی تسک</h2>
<p>شما باید یک سیستم مدیریت فایل ساده طراحی کنید که دارای ویژگی‌های زیر باشد:</p>

<ol>
  <li><b>ساختار درختی (Tree View)</b> برای نمایش فایل‌ها و فولدرها.</li>
  <li>امکان <b>اضافه کردن، حذف کردن، و تغییر نام</b> فایل‌ها و فولدرها از طریق رابط کاربری.</li>
  <li>ذخیره و مدیریت فایل‌ها و فولدرها در <b>IndexedDB</b>.</li>
  <li>استفاده از <b>Web Worker</b> برای انجام عملیات مرتبط با IndexedDB (مانند ذخیره‌سازی، حذف، و بازیابی داده‌ها) و برقراری ارتباط بین رابط کاربری و دیتابیس.</li>
</ol>

<hr />

<h2>جزئیات تسک</h2>

<h3>بخش اول: رابط کاربری (UI)</h3>
<p>شما باید یک رابط کاربری ساده طراحی کنید که به صورت <b>ساختار درختی</b> فایل‌ها و فولدرها را نمایش دهد.</p>

<h4>ویژگی‌های رابط کاربری:</h4>
<ol>
  <li><b>نمایش فایل‌ها و فولدرها:</b>  
    فایل‌ها و فولدرها باید در قالب یک <b>نمای درختی</b> نمایش داده شوند.
  </li>
  <li><b>اضافه کردن فایل یا فولدر:</b>  
    با کلیک روی یک فولدر، دکمه‌ای برای <b>اضافه کردن فایل یا فولدر جدید</b> نمایش داده شود.
  </li>
  <li><b>تغییر نام فایل یا فولدر:</b>  
    کاربر باید بتواند با زدن دکمه ویرایش، نام فایل یا فولدر را تغییر دهد.
  </li>
  <li><b>حذف فایل یا فولدر:</b>  
    کاربر باید بتواند فایل‌ها یا فولدرها را حذف کند. حذف یک فولدر باید تمام محتویات آن (فایل‌ها و فولدرهای داخلی) را نیز حذف کند.
  </li>
</ol>

<h3>بخش دوم: Web Worker</h3>
<p>ورکر تنها مسئول انجام تمام عملیات مربوط به IndexedDB است و رابط کاربری تنها از طریق ارسال پیام‌ها با آن تعامل دارد.</p>

<h4>ویژگی‌های مورد انتظار از Web Worker:</h4>
<ol>
  <li><b>دریافت پیام‌ها از UI برای انجام عملیات زیر:</b>
    <ul>
      <li>افزودن فایل یا فولدر.</li>
      <li>حذف فایل یا فولدر.</li>
      <li>تغییر نام فایل یا فولدر.</li>
      <li>بازیابی داده‌ها برای بارگذاری مجدد درخت فایل هنگام شروع برنامه.</li>
    </ul>
  </li>
  <li><b>ذخیره و بازیابی داده‌ها در IndexedDB:</b>
    <ul>
      <li>تمام داده‌ها (فایل‌ها و فولدرها) باید در IndexedDB ذخیره شوند.</li>
      <li>ورکر باید هنگام شروع برنامه داده‌ها را از IndexedDB خوانده و به UI ارسال کند.</li>
    </ul>
  </li>
</ol>

<h3>بخش سوم: IndexedDB</h3>
<p>فایل‌ها و فولدرها باید در IndexedDB ذخیره شوند. هر فایل یا فولدر باید دارای یک ساختار داده مشخص باشد:</p>

<pre>
{
  id: "unique_id",
  name: "file_or_folder",
  type: "file" | "folder",
  parentId: "parent_id",
}
</pre>

<h4>عملیات IndexedDB:</h4>
<ol>
  <li><b>افزودن:</b> افزودن یک فایل یا فولدر جدید به دیتابیس.</li>
  <li><b>حذف:</b> حذف یک فایل یا فولدر و تمام زیرمجموعه‌های آن.</li>
  <li><b>بازیابی:</b> بازگرداندن کل ساختار فایل‌ها و فولدرها به صورت سلسله‌مراتبی.</li>
  <li><b>به‌روزرسانی:</b> تغییر نام فایل یا فولدر.</li>
</ol>

<h3>بخش چهارم: ارتباط بین UI و Web Worker</h3>
<p>ارتباط UI با Web Worker از طریق پیام‌ها انجام می‌شود:</p>


پیام‌های UI به Web Worker:

افزودن فایل یا فولدر:

```
worker.postMessage({ action: "add", data: { name, type, parentId } });
```
حذف فایل یا فولدر:

```
worker.postMessage({ action: "delete", data: { id } });
```
تغییر نام فایل یا فولدر:
```
worker.postMessage({ action: "rename", data: { id, newName } });
```
بازیابی داده‌ها:
```
worker.postMessage({ action: "fetch" });
```
پیام‌های Web Worker به UI:
ورکر باید نتیجه عملیات را به UI ارسال کند.
مثال:

```
self.postMessage({ action: "updateTree", data: updatedTree });
```

شما باید کدهای زیر را ارسال کنید:

- کد Web Worker: مدیریت IndexedDB و ارتباط با UI.
- کد رابط کاربری: شامل HTML، CSS، و جاوااسکریپت.
- توضیح مختصری از معماری و نحوه عملکرد برنامه.
